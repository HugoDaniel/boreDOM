<!DOCTYPE html>
<!--
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         DEPLOYMENT GUIDE                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  This is a complete, production-ready app in a single HTML file.             â•‘
â•‘  No build step. No npm install. No bundler configuration.                    â•‘
â•‘                                                                              â•‘
â•‘  TO DEPLOY: Copy this file + boreDOM.prod.js to any static host.             â•‘
â•‘  See time-tracker.html for full deployment documentation.                    â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping List</title>
  <style>
    /*
     * CSS Layers: One layer per component for easy overrides.
     * Unlayered styles always win over layered styles - no !important needed.
     * Learn more: https://developer.mozilla.org/en-US/docs/Web/CSS/@layer
     */

    /* Base layer: resets and page-level defaults */
    @layer base {
      * { box-sizing: border-box; }
      body {
        font-family: system-ui, -apple-system, sans-serif;
        max-width: 500px;
        margin: 0 auto;
        padding: 20px;
        background: #f0fdf4;
        color: #333;
      }
    }

    /* Shopping-list component layer */
    @layer shopping-list {
      shopping-list h1 {
        margin-bottom: 20px;
        color: #166534;
      }

      shopping-list .card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }

      shopping-list .add-form {
        display: flex;
        gap: 8px;
        margin-bottom: 20px;
      }

      shopping-list input[type="text"] {
        flex: 1;
        padding: 12px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 16px;
      }
      shopping-list input:focus {
        outline: none;
        border-color: #22c55e;
      }

      shopping-list button {
        background: #22c55e;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
      }
      shopping-list button:hover { background: #16a34a; }

      shopping-list .item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
      }
      shopping-list .item:last-child { border-bottom: none; }

      shopping-list .item input[type="checkbox"] {
        width: 20px;
        height: 20px;
        cursor: pointer;
      }

      shopping-list .item-name {
        flex: 1;
        font-size: 16px;
      }
      shopping-list .item.checked .item-name {
        text-decoration: line-through;
        color: #9ca3af;
      }

      shopping-list .item button {
        background: #ef4444;
        padding: 6px 12px;
        font-size: 14px;
      }
      shopping-list .item button:hover { background: #dc2626; }

      shopping-list .empty {
        text-align: center;
        color: #9ca3af;
        padding: 40px 20px;
      }

      shopping-list .stats {
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
        font-size: 14px;
        color: #6b7280;
        display: flex;
        justify-content: space-between;
      }

      shopping-list .clear-btn {
        background: #6b7280;
        padding: 8px 16px;
        font-size: 14px;
      }
      shopping-list .clear-btn:hover { background: #4b5563; }
    }
  </style>
</head>
<body>
  <shopping-list></shopping-list>

  <template data-component="shopping-list">
    <div class="card">
      <h1>ðŸ›’ Shopping List</h1>

      <div class="add-form">
        <input type="text" data-ref="input" placeholder="Add item..."
               onkeyup="dispatch('keypress')">
        <button onclick="dispatch('add')">Add</button>
      </div>

      <div data-ref="items"></div>

      <div data-ref="stats"></div>
    </div>
  </template>

  <script type="module">
    import { inflictBoreDOM, webComponent } from '../../dist/boreDOM.min.js'

    // Load from localStorage
    const loadItems = () => {
      try {
        const saved = localStorage.getItem('shoppingList')
        return saved ? JSON.parse(saved) : []
      } catch {
        return []
      }
    }

    // Save to localStorage
    const saveItems = (items) => {
      localStorage.setItem('shoppingList', JSON.stringify(items))
    }

    inflictBoreDOM(
      {
        items: loadItems()
      },
      {
        "shopping-list": webComponent(({ state, on, refs }) => {

          on('add', ({ state: mutableState }) => {
            const text = refs.input.value.trim()
            if (!text) return

            mutableState.items.push({
              id: Date.now(),
              name: text,
              checked: false
            })

            refs.input.value = ''
            saveItems(mutableState.items)
          })

          on('keypress', ({ e }) => {
            if (e.event.key === 'Enter') {
              refs.input.dispatchEvent(new Event('add', { bubbles: true }))
            }
          })

          on('toggle', ({ state: mutableState, e }) => {
            const id = parseInt(e.dispatcher.dataset.id)
            const item = mutableState.items.find(i => i.id === id)
            if (item) {
              item.checked = !item.checked
              saveItems(mutableState.items)
            }
          })

          on('remove', ({ state: mutableState, e }) => {
            const id = parseInt(e.dispatcher.dataset.id)
            const index = mutableState.items.findIndex(i => i.id === id)
            if (index !== -1) {
              mutableState.items.splice(index, 1)
              saveItems(mutableState.items)
            }
          })

          on('clearChecked', ({ state: mutableState }) => {
            // Filter in place by splicing from end
            for (let i = mutableState.items.length - 1; i >= 0; i--) {
              if (mutableState.items[i].checked) {
                mutableState.items.splice(i, 1)
              }
            }
            saveItems(mutableState.items)
          })

          return ({ state, refs }) => {
            const items = state.items
            const checkedCount = items.filter(i => i.checked).length
            const totalCount = items.length

            // Render items
            if (items.length === 0) {
              refs.items.innerHTML = '<div class="empty">Your list is empty. Add some items!</div>'
            } else {
              refs.items.innerHTML = items.map(item => `
                <div class="item ${item.checked ? 'checked' : ''}">
                  <input type="checkbox"
                         ${item.checked ? 'checked' : ''}
                         onclick="dispatch('toggle')"
                         data-id="${item.id}">
                  <span class="item-name">${item.name}</span>
                  <button onclick="dispatch('remove')" data-id="${item.id}">Remove</button>
                </div>
              `).join('')
            }

            // Render stats
            if (totalCount > 0) {
              refs.stats.innerHTML = `
                <div class="stats">
                  <span>${checkedCount} of ${totalCount} items checked</span>
                  ${checkedCount > 0
                    ? '<button class="clear-btn" onclick="dispatch(\'clearChecked\')">Clear checked</button>'
                    : ''}
                </div>
              `
            } else {
              refs.stats.innerHTML = ''
            }
          }
        })
      }
    ).then(() => {
      console.log('%c Shopping List Ready! ', 'background: #22c55e; color: white; padding: 4px 8px; border-radius: 4px;')
    })
  </script>
</body>
</html>
