<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>boreDOM Metadata Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .demo-section {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .metadata-display {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        button:hover {
            background: #005a87;
        }
        
        counter-component {
            display: inline-block;
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 20px;
            margin: 10px 0;
        }
        
        counter-component button {
            background: #333;
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <h1>boreDOM Metadata Demo</h1>
    
    <p>This demo shows how semantic component descriptions work in boreDOM for LLM integration.</p>
    
    <div class="demo-section">
        <h2>Counter Component</h2>
        
        <div class="demo-content">
            <counter-component></counter-component>
        </div>
        
        <h3>Component Metadata</h3>
        <div class="metadata-display" id="counter-metadata">
            Loading metadata...
        </div>
        
        <button onclick="showMetadata()">Show Metadata</button>
        <button onclick="showLLMFormat()">Show LLM Format</button>
    </div>

    <div class="demo-section">
        <h2>How It Works</h2>
        
        <ol>
            <li><strong>Metadata Registration</strong>: Components register their metadata during initialization</li>
            <li><strong>Minification</strong>: Full metadata is converted to compact format for production</li>
            <li><strong>Global Registry</strong>: Metadata is available via <code>window.__BOREDOM_META__</code></li>
            <li><strong>LLM Access</strong>: LLMs can parse the metadata to understand component capabilities</li>
            <li><strong>Code Generation</strong>: LLMs use metadata to generate appropriate component usage</li>
        </ol>
        
        <h3>Metadata Structure</h3>
        <pre>
{
  "t": "component type",
  "p": "purpose description",
  "s": {"stateVar": "type"},
  "e": ["event1", "event2"],
  "r": ["ref1", "ref2"],
  "sl": ["slot1", "slot2"],
  "ex": "&lt;component&gt;&lt;/component&gt;"
}</pre>
    </div>

    <script type="module">
        // Import boreDOM (this would be the minified version in production)
        import boreDOM from '../dist/boreDOM.min.js';
        
        // Counter component with metadata
        const counterMetadata = {
            t: 'counter',
            p: 'Incremental counter with display and controls',
            s: { count: 'number' },
            e: ['increment', 'decrement', 'reset'],
            r: ['display', 'incrementBtn', 'decrementBtn', 'resetBtn'],
            ex: '<counter-component data-initial="0"></counter-component>'
        };
        
        // Register the counter component
        boreDOM.define('counter-component', {
            template: `
                <div>
                    <button data-ref="decrementBtn" data-dispatch="decrement">-</button>
                    <span data-ref="display" data-text="count"></span>
                    <button data-ref="incrementBtn" data-dispatch="increment">+</button>
                    <button data-ref="resetBtn" data-dispatch="reset">Reset</button>
                </div>
            `,
            logic: ({ state, on }) => {
                // Initialize state
                const initialValue = parseInt(state.self.getAttribute('data-initial') || '0');
                state.count = initialValue;
                
                // Event handlers
                on('increment', () => state.count++);
                on('decrement', () => state.count--);
                on('reset', () => state.count = 0);
                
                return ({ state }) => {
                    // Render logic
                    state.self.style.backgroundColor = state.count > 0 ? '#e6f7ff' : '#f0f0f0';
                };
            },
            __meta__: counterMetadata
        });
        
        // Make metadata available globally (as it would be in minified build)
        window.__BOREDOM_META__ = {
            'counter-component': counterMetadata
        };
        
        // UI functions
        function showMetadata() {
            const metadata = window.__BOREDOM_META__['counter-component'];
            document.getElementById('counter-metadata').textContent = 
                JSON.stringify(metadata, null, 2);
        }
        
        function showLLMFormat() {
            const metadata = window.__BOREDOM_META__['counter-component'];
            const llmFormat = {
                component: 'counter-component',
                type: metadata.t,
                purpose: metadata.p,
                state: metadata.s,
                events: metadata.e,
                example: metadata.ex,
                usage: 'Use for counting operations, tracking quantities, or simple numeric displays'
            };
            document.getElementById('counter-metadata').textContent = 
                JSON.stringify(llmFormat, null, 2);
        }
        
        // Show metadata by default
        showMetadata();
    </script>
</body>
</html>