var Ft=Object.defineProperty;var v=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ht=(e,t)=>{for(var r in t)Ft(e,r,{get:t[r],enumerable:!0})};function Ve(e,t,r){R=e,t&&(ue=t),r&&(fe=r)}function h(){return R}function Je(e,t){typeof __DEBUG__<"u"&&!__DEBUG__||u("api")&&qe.set(e,t)}function Wt(e){return typeof e=="function"&&e[pe]===!0}function de(e,t,r){if(typeof __DEBUG__<"u"&&!__DEBUG__)return console.warn("[boreDOM] define() is not available in production build"),!1;if(!u("api"))return console.warn("[boreDOM] define() is disabled (debug.api is false)"),!1;if(!R)throw new Error("[boreDOM] Cannot define component before inflictBoreDOM()");if(!e.includes("-"))throw new Error(`[boreDOM] Invalid tag name "${e}": must contain a hyphen`);if(customElements.get(e))throw new Error(`[boreDOM] Component "${e}" is already defined`);if(!ue||!fe)throw new Error("[boreDOM] Console API not initialized. Call inflictBoreDOM() first.");let n=R,o=ue,i=fe,s=document.createElement("template");s.innerHTML=t,s.setAttribute("data-component",e),document.body.appendChild(s);let a=Wt(r)?r:o(r);return n.internal.components.set(e,a),n.internal.customTags.push(e),i(e),zt(e,a),u("console")&&console.log("%c\u2705 boreDOM: Defined %c<%s>","color: #27ae60; font-weight: bold","color: #4ecdc4; font-weight: bold",e),!0}function zt(e,t){if(!R)return;let r=Array.from(document.querySelectorAll(e)),n={count:0};r.forEach((o,i)=>{if(o instanceof HTMLElement&&"renderCallback"in o)try{let a=t(R,{index:i,name:e,data:void 0});o.renderCallback=a,a(o)}catch(s){n.count++,u("console")&&console.error(`[boreDOM] Failed to initialize <${e}> instance ${i}:`,s)}}),n.count>0&&u("console")&&console.warn(`[boreDOM] ${n.count} of ${r.length} <${e}> instances failed to initialize`)}function Ke(e,t=0){if(typeof __DEBUG__<"u"&&!__DEBUG__){console.warn("[boreDOM] operate() is not available in production build");return}if(!u("api")){console.warn("[boreDOM] operate() is disabled (debug.api is false)");return}let r=null;if(typeof e=="string"?r=Array.from(document.querySelectorAll(e)).filter(i=>i instanceof HTMLElement)[t]??null:r=e,!r){u("console")&&console.warn(`[boreDOM] operate(): No element found for "${e}"`);return}let n=qe.get(r);if(!n){u("console")&&console.warn("[boreDOM] operate(): Element is not a boreDOM component or not initialized");return}return n}function qt(e){if(typeof __DEBUG__<"u"&&!__DEBUG__)return console.warn("[boreDOM] exportComponent() is not available in production build"),null;if(!u("api"))return console.warn("[boreDOM] exportComponent() is disabled (debug.api is false)"),null;let t=Ke(e);if(!t)return null;let n=document.querySelector(`template[data-component="${t.detail.name}"]`)?.innerHTML??void 0;try{return{component:t.detail.name,state:JSON.parse(JSON.stringify(t.state)),template:n,timestamp:new Date().toISOString()}}catch(o){return u("console")&&console.warn(`[boreDOM] exportComponent: Unable to serialize state for <${t.detail.name}>:`,o instanceof Error?o.message:o),{component:t.detail.name,state:"[Unable to serialize - contains circular references or functions]",template:n,timestamp:new Date().toISOString()}}}var pe,R,ue,fe,qe,Q,Y=v(()=>{"use strict";A();pe=Symbol("boreDOM.webComponent"),R=null,ue=null,fe=null,qe=new WeakMap;Q={define:de,operate:Ke,exportComponent:qt}});function Xe(e,t,r){return typeof __DEBUG__<"u"&&!__DEBUG__?{}:u("methodMissing")?new Proxy({},{get(n,o){if(!(typeof o=="symbol"||o==="then"||o==="toJSON")){if(U.has(o)){let i=U.get(o);return(...s)=>{let a=i(...s);return(typeof __DEBUG__>"u"||__DEBUG__)&&rt(o,s,a),a}}return(...i)=>{let s={name:o,args:i,component:e,element:t,timestamp:Date.now(),define:a=>{Ze(o,a),r()}};Kt(s),Qt(s),Yt(s)}}},has(n,o){return typeof o=="string"&&U.has(o)}}):{}}function Ze(e,t){typeof __DEBUG__<"u"&&!__DEBUG__||u("methodMissing")&&(U.set(e,t),u("console")&&console.log("%c\u2705 boreDOM: Defined helper %c%s","color: #27ae60; font-weight: bold","color: #9b59b6; font-weight: bold",e))}function Vt(e){U.delete(e)}function Jt(){X.clear(),ge=null}function Kt(e){u("console")&&(console.log("%c\u26A0\uFE0F boreDOM: Missing function %c%s%c in <%s>","color: #f39c12; font-weight: bold","color: #9b59b6; font-weight: bold",e.name,"color: #f39c12",e.component),e.args.length>0&&console.log("   Arguments:",e.args),console.log("%c\u{1F4A1} Define it:","color: #3498db; font-weight: bold"),console.log(`   $defineMissing((${Qe(e.args)}) => { ... })`),console.log(`   boreDOM.defineHelper('${e.name}', (${Qe(e.args)}) => { ... })`))}function Qe(e){return e.length===0?"":e.map((t,r)=>t==null?`arg${r}`:Array.isArray(t)?"items":typeof t=="object"?"name"in t&&"email"in t?"user":"id"in t&&"title"in t?"item":"id"in t?"record":"data":typeof t=="string"?"text":typeof t=="number"?"count":typeof t=="boolean"?"flag":`arg${r}`).join(", ")}function Qt(e){if(!u("errorHistory"))return;let t=X.get(e.name)||[];t.length>=10&&t.shift(),t.push(e),X.set(e.name,t),ge=e}function Yt(e){if(!u("globals")||typeof window>"u")return;let t=window;t.$missingName=e.name,t.$missingArgs=e.args,t.$missingComponent=e.component,t.$defineMissing=e.define}function et(e,t){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("templateInference")||u("strict"))return null;let r={},n=[];if(t){for(let a of Array.from(t.attributes)){if(a.name.startsWith("data-")||["class","id","style"].includes(a.name))continue;let c=en(a.name);r[c]=tn(a.value)}for(let a of Array.from(t.children)){let c=a.getAttribute("slot");c&&!n.includes(c)&&n.push(c)}}let o=Object.keys(r).map(a=>`    <slot name="${nt(a)}">${nn(r[a])}</slot>`).join(`
`),i=n.length===0&&Object.keys(r).length===0?'    <slot name="content">Loading...</slot>':"",s=`<div class="${e}-skeleton" data-inferred>
${o||i}
  </div>`;return{tagName:e,template:s,props:r,slots:n}}function Xt(e,t){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("templateInference")||customElements.get(e)||!h())return!1;let r=et(e,t);if(!r)return!1;let{template:n,props:o}=r;Ye.set(e,r),Zt(e,o);try{return de(e,n,({state:i})=>({slots:s})=>{u("console")&&(console.log("%c\u{1F52E} boreDOM: Inferred <%s> rendering","color: #9b59b6; font-weight: bold",e),console.log("   Inferred props:",o),console.log("   App state:",i));for(let[a,c]of Object.entries(o)){let l=nt(a);s[l]&&(s[l]=String(c))}}),!0}catch(i){return u("console")&&console.warn(`[boreDOM] Failed to register inferred <${e}>:`,i),!1}}function Zt(e,t){if(u("console")){if(console.log("%c\u{1F52E} boreDOM: Inferring template for %c<%s>","color: #9b59b6; font-weight: bold","color: #4ecdc4; font-weight: bold",e),Object.keys(t).length>0){console.log("%c\u{1F4CB} Inferred props from attributes:","color: #95a5a6");for(let[r,n]of Object.entries(t))console.log(`   ${r}: ${JSON.stringify(n)}`)}console.log("%c\u{1F4A1} Define properly with:","color: #3498db; font-weight: bold"),console.log(`   boreDOM.define('${e}', '<your template>', ({ state }) => ({ slots }) => { ... })`)}}function tt(){typeof __DEBUG__<"u"&&!__DEBUG__||u("templateInference")&&(typeof window>"u"||me||(me=new MutationObserver(e=>{for(let t of e)for(let r of Array.from(t.addedNodes))if(r instanceof HTMLElement&&r.tagName.includes("-")){let n=r.tagName.toLowerCase();customElements.get(n)||document.querySelector(`template[data-component="${n}"]`)||queueMicrotask(()=>{customElements.get(n)||Xt(n,r)})}}),me.observe(document.body,{childList:!0,subtree:!0})))}function en(e){return e.replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function nt(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function tn(e){if(e==="true")return!0;if(e==="false")return!1;let t=Number(e);if(!isNaN(t)&&e!=="")return t;if(e.startsWith("{")||e.startsWith("["))try{return JSON.parse(e)}catch{return e}return e}function nn(e){return e==null?"":typeof e=="object"?JSON.stringify(e):String(e)}var U,X,ge,Ye,me,m,ye=v(()=>{"use strict";A();Y();Z();U=new Map,X=new Map,ge=null,Ye=new Map,me=null;m={get missingFunctions(){return X},get lastMissing(){return ge},defineHelper:Ze,get helpers(){return new Map(U)},clearHelper:Vt,clearMissingFunctions:Jt,get inferredTemplates(){return Ye},inferTemplate:et}});var T,ee=v(()=>{"use strict";T="0.25.25"});function z(e){b=e}function he(){return b?M(b.app):null}function te(e){if(!b||!e)return;let t=b.app;if(t){for(let r of Object.keys(t))r in e||delete t[r];for(let[r,n]of Object.entries(e))t[r]=M(n)}}function M(e,t=new WeakMap){if(e===null||typeof e!="object")return e;if(t.has(e))return t.get(e);if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(e instanceof Map){let n=new Map;t.set(e,n);for(let[o,i]of e.entries())n.set(M(o,t),M(i,t));return n}if(e instanceof Set){let n=new Set;t.set(e,n);for(let o of e)n.add(M(o,t));return n}if(Array.isArray(e)){let n=new Array(e.length);t.set(e,n);for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=M(e[o],t));return n}let r={};t.set(e,r);for(let[n,o]of Object.entries(e))r[n]=M(o,t);return r}function rn(e){let t=[];try{new Function("state","boreDOM",e)}catch(r){let n=r;t.push({type:"syntax",message:n.message,location:on(n),severity:"error"})}return t}function on(e){let t=e.message.match(/at position (\d+)/);if(t)return`position ${t[1]}`;let r=e.message.match(/line (\d+)/);if(r)return`line ${r[1]}`}function sn(e){let t=[];if(!b)return t;let r=b.app,n=be(r),o=pn(),i=an(e);for(let a of i)if(!ln(a,n)){let c=un(a,n);t.push({type:"reference",message:`${a} is undefined`,suggestion:c?`Did you mean ${c}?`:void 0,severity:"error"})}let s=cn(e);for(let a of s)if(!o.includes(a)){let c=fn(a,o);t.push({type:"reference",message:`Helper '${a}' is not defined`,suggestion:c?`Did you mean '${c}'?`:void 0,severity:"error"})}return t}function an(e){let t=[],r=/state\.([\w.[\]]+)/g,n;for(;(n=r.exec(e))!==null;){let o=n[1],i=/\.(push|pop|shift|unshift|map|filter|reduce|forEach|find|findIndex|some|every|indexOf|includes|splice|slice|concat|join|reverse|sort|flat|flatMap|at|fill|copyWithin|entries|keys|values|length|size|get|set|has|delete|add|clear|toString|valueOf|toJSON)$/;o=o.replace(i,""),o&&t.push(`state.${o}`)}return[...new Set(t)]}function cn(e){let t=[],r=/helpers\.(\w+)\s*\(/g,n;for(;(n=r.exec(e))!==null;)t.push(n[1]);return[...new Set(t)]}function be(e,t="state",r=new WeakSet){let n=[t];if(e==null||typeof e!="object"||r.has(e))return n;r.add(e);for(let o of Object.keys(e)){let i=`${t}.${o}`;n.push(i);let s=e[o];Array.isArray(s)?(n.push(i),s.length>0&&s[0]&&typeof s[0]=="object"&&n.push(...be(s[0],`${i}[0]`,r))):s&&typeof s=="object"&&n.push(...be(s,i,r))}return n}function ln(e,t){if(t.includes(e))return!0;let r=e.replace(/\[\d+\]/g,"");if(t.includes(r))return!0;let n=e.replace(/\[\d+\]\.[\w.]+$/,"");return!!(t.includes(n)||t.includes(`${n}[0]`))}function un(e,t){let r,n=1/0;for(let o of t){let i=st(e,o);i<n&&i<e.length/2&&(n=i,r=o)}return r}function fn(e,t){for(let r of t)if(st(e,r)<=2)return r}function st(e,t){let r=[];for(let n=0;n<=t.length;n++)r[n]=[n];for(let n=0;n<=e.length;n++)r[0][n]=n;for(let n=1;n<=t.length;n++)for(let o=1;o<=e.length;o++)t.charAt(n-1)===e.charAt(o-1)?r[n][o]=r[n-1][o-1]:r[n][o]=Math.min(r[n-1][o-1]+1,r[n][o-1]+1,r[n-1][o]+1);return r[t.length][e.length]}function pn(){if(typeof window>"u")return[];let e=window.boreDOM;return e?.helpers?Array.from(e.helpers.keys()):[]}function dn(e){let t=[],r=[{pattern:/\.map\s*\(/,method:"map"},{pattern:/\.filter\s*\(/,method:"filter"},{pattern:/\.forEach\s*\(/,method:"forEach"},{pattern:/\.reduce\s*\(/,method:"reduce"},{pattern:/\.find\s*\(/,method:"find"},{pattern:/\.some\s*\(/,method:"some"},{pattern:/\.every\s*\(/,method:"every"}];for(let{pattern:i,method:s}of r)if(i.test(e)){let a=new RegExp(`(state\\.[\\w.]+)\\.${s}\\s*\\(`),c=e.match(a);if(c){let l=c[1],f=ot(l);f==null?t.push({type:"type",message:`${l} is ${f}, cannot call .${s}()`,suggestion:`Add null check: ${l}?.${s}(...) or initialize ${l} first`,severity:"error"}):Array.isArray(f)||t.push({type:"type",message:`${l} is not an array, cannot call .${s}()`,suggestion:`Ensure ${l} is an array before calling .${s}()`,severity:"error"})}}let n=/state\.([\w.]+)\.([\w]+)/g,o;for(;(o=n.exec(e))!==null;){let i=`state.${o[1]}`,s=ot(i);s==null&&t.push({type:"type",message:`${i} is ${s}, cannot read property '${o[2]}'`,suggestion:`Add null check: ${i}?.${o[2]} or initialize ${i} first`,severity:"warning"})}return(e.includes("await ")||e.includes("async "))&&t.push({type:"warning",message:"Async code detected - apply() executes synchronously",suggestion:"Use regular synchronous code or handle async separately",severity:"warning"}),t}function ot(e){if(!b)return;let t=e.replace("state.","").split("."),r=b.app;for(let n of t){if(r==null)return r;let o=n.match(/^(\w+)\[(\d+)\]$/);if(o)if(r=r[o[1]],Array.isArray(r))r=r[parseInt(o[2],10)];else return;else r=r[n]}return r}function it(e,t,r="state"){let n=[];if(e===t)return n;if(typeof e!=typeof t)return n.push({path:r,before:e,after:t}),n;if(Array.isArray(e)&&Array.isArray(t))return JSON.stringify(e)!==JSON.stringify(t)&&n.push({path:r,before:e,after:t}),n;if(typeof e=="object"&&e!==null&&t!==null){let o=new Set([...Object.keys(e),...Object.keys(t)]);for(let i of o)n.push(...it(e[i],t[i],`${r}.${i}`));return n}return e!==t&&n.push({path:r,before:e,after:t}),n}function mn(e){return[]}function _e(e){if(typeof __DEBUG__<"u"&&!__DEBUG__)return{valid:!0,issues:[]};if(!u("llm"))return{valid:!0,issues:[]};let t=[...rn(e),...sn(e),...dn(e)];return{valid:t.filter(n=>n.severity==="error").length===0,issues:t}}function Ee(e){if(typeof __DEBUG__<"u"&&!__DEBUG__)return{success:!1,error:"apply() not available in production",rollback:()=>{},componentsAffected:[],stateChanges:[]};if(!u("llm"))return{success:!1,error:"LLM API is disabled",rollback:()=>{},componentsAffected:[],stateChanges:[]};let t=he(),r=M(t),n=_e(e);if(!n.valid){let o=n.issues.filter(i=>i.severity==="error").map(i=>i.message).join("; ");return F(e,"error",o),{success:!1,error:`Validation failed: ${o}`,rollback:()=>{},componentsAffected:[],stateChanges:[]}}try{new Function("state","boreDOM",e)(b?.app,typeof window<"u"?window.boreDOM:void 0);let i=he(),s=it(r,i);return F(e,"success"),{success:!0,rollback:()=>te(t),componentsAffected:mn(s),stateChanges:s}}catch(o){te(t);let i=o;return F(e,"error",i.message),{success:!1,error:i.message,rollback:()=>{},componentsAffected:[],stateChanges:[]}}}function at(e){if(typeof __DEBUG__<"u"&&!__DEBUG__)return{success:!1,results:[],rollbackAll:()=>{},error:"applyBatch() not available in production"};if(!u("llm"))return{success:!1,results:[],rollbackAll:()=>{},error:"LLM API is disabled"};let t=he(),r=[];for(let n=0;n<e.length;n++){let o=Ee(e[n]);if(r.push(o),!o.success)return te(t),{success:!1,results:r,rollbackAll:()=>{},error:o.error,failedIndex:n}}return{success:!0,results:r,rollbackAll:()=>te(t)}}var b,ct=v(()=>{"use strict";A();ne();b=null});var Et={};Ht(Et,{clearAttempts:()=>_t,context:()=>yt,copy:()=>ht,focus:()=>ke,formatErrorForLLM:()=>wn,getAttempts:()=>bt,isLLMOutputFormat:()=>Mn,llmAPI:()=>ve,llmLog:()=>An,recordAttempt:()=>F,setValidationAppState:()=>z});function yn(e,t){if(e===t)return!0;if(!e||!t||typeof e!="object"||typeof t!="object")return!1;try{let r=Date.now()+Math.random();e[Se]=r;let n=t[Se]===r;return delete e[Se],n}catch{return!1}}function we(e,t="",r=new WeakSet){let n=[];if(e==null||typeof e!="object"||r.has(e))return n;r.add(e);for(let o of Object.keys(e)){let i=t?`${t}.${o}`:o;n.push(i);let s=e[o];Array.isArray(s)?(n.push(`${i}[]`),s.length>0&&typeof s[0]=="object"&&s[0]!==null&&n.push(...we(s[0],`${i}[0]`,r))):s&&typeof s=="object"&&n.push(...we(s,i,r))}return n}function Ae(e,t=new WeakSet){return e===null?"null":e===void 0?"undefined":Array.isArray(e)?e.length===0?"any[]":`${Ae(e[0],t)}[]`:typeof e=="object"?t.has(e)?"/* circular */":(t.add(e),`{
${Object.entries(e).map(([n,o])=>`  ${n}: ${Ae(o,t)}`).join(`
`)}
}`):typeof e}function _(e,t=new WeakSet,r){if(e==null||typeof e!="object")return e;if(typeof e=="function")return"[Function]";if(typeof e=="symbol")return"[Symbol]";if(e instanceof Date)return e.toISOString();if(e instanceof RegExp)return e.toString();if(e instanceof Map)return"[Map]";if(e instanceof Set)return"[Set]";if(r===void 0&&(r=e),t.has(e))return"[Circular]";t.add(e);let n=Array.isArray(e)?[]:{};for(let[o,i]of Object.entries(e))gn.some(a=>o.toLowerCase().includes(a.toLowerCase()))?n[o]="[REDACTED]":i&&typeof i=="object"?yn(i,r)||t.has(i)?n[o]="[Circular]":n[o]=_(i,t,r):typeof i=="function"?n[o]="[Function]":typeof i=="symbol"?n[o]="[Symbol]":n[o]=i;return n}function ft(e){let t=e.error.message.toLowerCase();if(t.includes("undefined")&&t.includes("reading")){let r=t.match(/reading '(\w+)'/);if(r)return`Property access on null/undefined. Add null check before accessing '${r[1]}' or initialize the value.`}if(t.includes("is not a function")){let r=t.match(/(\w+) is not a function/);if(r)return`'${r[1]}' is not a function. Check if it's defined, imported, or if the object exists.`}return t.includes("map")||t.includes("filter")||t.includes("foreach")?"Array method called on non-array. Initialize as empty array or add type check.":t.includes("null")||t.includes("undefined")?"Null/undefined value encountered. Add defensive checks or initialize data.":"Check the error message and component state for the root cause."}function xe(){return w.errors}function pt(){return m.missingFunctions}function hn(){return m.helpers}function dt(){if(typeof document>"u")return[];let e=[],t=document.querySelectorAll("*");for(let r of Array.from(t)){let n=r.tagName.toLowerCase();n.includes("-")&&!customElements.get(n)&&(e.includes(n)||e.push(n))}return e}function mt(){let e=h();return e?e.internal.customTags||[]:[]}function bn(e){return typeof document>"u"?null:document.querySelector(`template[data-component="${e}"]`)?.innerHTML??null}function _n(e){return typeof document>"u"?0:document.querySelectorAll(e).length}function Me(e){let r=h()?.internal.components.has(e)??!1,n=bn(e),o=_n(e),s=xe().has(e),a=[],c=[];if(n){let l=document.createElement("div");l.innerHTML=n,l.querySelectorAll("[data-ref]").forEach(f=>{let p=f.getAttribute("data-ref");p&&a.push(p)}),l.querySelectorAll("[data-slot], slot[name]").forEach(f=>{let p=f.getAttribute("data-slot")||f.getAttribute("name");p&&c.push(p)})}return{tagName:e,template:n,hasLogic:r,refs:a,slots:c,events:[],stateAccess:[],hasError:s,instanceCount:o}}function En(){let e=mt(),t={};for(let r of e)t[r]=Me(r);return t}function Sn(){let e=["reactive-state","web-components","event-handling"],t=H();return t.errorBoundary&&e.push("error-boundary"),t.globals&&e.push("debug-globals"),t.api&&e.push("runtime-define"),t.methodMissing&&e.push("method-missing"),t.templateInference&&e.push("template-inference"),e}function Cn(){let e=mt();return{eventNaming:"unknown",stateStructure:"unknown",componentNaming:e.length>0?e.every(r=>r.match(/^[a-z]+-[a-z]+(-[a-z]+)*$/))?"kebab-case (e.g., user-profile, todo-list)":"mixed":"unknown"}}function gt(e,t){if(t.length===0)return`${e}(): any`;let r=t.map((n,o)=>n===null?`arg${o}: null`:n===void 0?`arg${o}: undefined`:Array.isArray(n)?"items: any[]":typeof n=="object"?"data: object":`arg${o}: ${typeof n}`);return`${e}(${r.join(", ")}): any`}function lt(){return{framework:{name:"boreDOM",version:T,capabilities:[]},state:{shape:"{}",paths:[],sample:{}},components:{},issues:{errors:[],missingFunctions:[],missingComponents:[]},helpers:{defined:{},missing:{}},patterns:{eventNaming:"unknown",stateStructure:"unknown",componentNaming:"unknown"}}}function ut(){return{issue:{type:"none",description:"LLM features disabled or unavailable"},relevantState:{}}}function yt(){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return lt();let t=h()?.app??{},r=xe(),n=pt(),o=hn(),i=Array.from(r.values()).map(l=>({component:l.component,error:l.error.message,stack:l.stack,state:_(l.state),timestamp:l.timestamp})),s=[],a={};for(let[l,f]of n.entries()){let p=f.map(y=>y.args),d=[...new Set(f.map(y=>y.component))],V=Math.max(...f.map(y=>y.timestamp));s.push({name:l,args:f[0]?.args??[],component:f[0]?.component??"unknown",inferredSignature:gt(l,f[0]?.args??[]),callCount:f.length}),a[l]={args:p,components:d,lastCall:V}}let c={};for(let[l,f]of o.entries())c[l]=`${l}(${f.length>0?"...":""}): any`;return{framework:{name:"boreDOM",version:T,capabilities:Sn()},state:{shape:Ae(t),paths:we(t),sample:_(t)},components:En(),issues:{errors:i,missingFunctions:s,missingComponents:dt()},helpers:{defined:c,missing:a},patterns:Cn()}}function ke(){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return ut();let e=xe();if(e.size>0){let n=Array.from(e.values()),o=n[n.length-1];return{issue:{type:"error",description:o.error.message,component:o.component,suggestion:ft(o)},component:{...Me(o.component),currentState:_(o.state)},relevantState:_(o.state),previousAttempts:Ce()}}let t=pt();if(t.size>0){let n=Array.from(t.entries()),[o,i]=n[n.length-1],s=i[i.length-1];return{issue:{type:"missing_function",description:`Undefined function '${o}' called`,component:s?.component,suggestion:`Define helper: boreDOM.defineHelper("${o}", (${gt(o,s?.args??[]).split("(")[1]?.split(")")[0]||""}) => { /* implementation */ })`},component:s?.component?{...Me(s.component),currentState:_(h()?.app)}:void 0,relevantState:_(h()?.app),previousAttempts:Ce()}}let r=dt();if(r.length>0){let n=r[0];return{issue:{type:"missing_component",description:`Custom element <${n}> used but not defined`,suggestion:`Define component: boreDOM.define("${n}", "<template-html>", ({ state }) => ({ slots }) => { /* render */ })`},relevantState:_(h()?.app),previousAttempts:Ce()}}return{issue:{type:"none",description:"No current issues detected"},relevantState:_(h()?.app)}}function ht(){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return"{}";let e=ke(),t=JSON.stringify(e,null,2);return typeof navigator<"u"&&navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{u("console")&&console.log("%c\u{1F4CB} boreDOM: LLM context copied to clipboard","color: #27ae60; font-weight: bold")}).catch(()=>{u("console")&&(console.log("%c\u{1F4CB} boreDOM: Clipboard access failed, context logged below:","color: #f39c12; font-weight: bold"),console.log(t))}):u("console")&&(console.log("%c\u{1F4CB} boreDOM: Clipboard unavailable, context logged below:","color: #f39c12; font-weight: bold"),console.log(t)),t}function F(e,t,r){typeof __DEBUG__<"u"&&!__DEBUG__||u("llm")&&($.push({code:e,result:t,error:r,timestamp:Date.now()}),$.length>10&&($=$.slice(-10)))}function Ce(){return[...$]}function bt(){return[...$]}function _t(){$=[]}function wn(e){return JSON.stringify({type:"error",component:e.component,error:e.error.message,stack:e.stack,state:_(e.state),refs:Object.keys(e.refs),slots:Object.keys(e.slots),suggestion:ft(e),timestamp:e.timestamp})}function An(e,t){if(typeof __DEBUG__<"u"&&!__DEBUG__)return;H().outputFormat==="llm"&&console.log(JSON.stringify({type:e,...t}))}function Mn(){return H().outputFormat==="llm"}var $,gn,Se,ve,ne=v(()=>{"use strict";A();Y();ye();ee();Z();ct();$=[],gn=["password","token","secret","apiKey","api_key","auth","credential","private","key","pass"],Se=Symbol("__llm_circular_check__");ve={context:yt,focus:ke,copy:ht,get attempts(){return bt()},clearAttempts:_t,_recordAttempt:F,inferTypes:St,typeOf:Ct,_clearTypes:wt,validate:_e,apply:Ee,applyBatch:at,_setValidationAppState:z}});function u(e){if(typeof __DEBUG__<"u"&&!__DEBUG__)return e==="errorBoundary"?L.errorBoundary??!0:!1;let t=L[e];return e==="strict"?t??!1:t??!0}function re(e){if(typeof e=="boolean"){let t=e;L={console:t,globals:t,errorBoundary:!0,visualIndicators:t,errorHistory:t,versionLog:t,api:t,methodMissing:t,templateInference:t,strict:!1,outputFormat:"human",llm:t}}else L={...L,...e}}function H(){return{...L}}function At(e){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("globals")||typeof window>"u")return;let t=window;t.$state=e.state,t.$refs=e.refs,t.$slots=e.slots,t.$self=e.element,t.$error=e.error,t.$component=e.component,t.$rerender=e.rerender}function Mt(){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("globals")||typeof window>"u")return;let e=window;delete e.$state,delete e.$refs,delete e.$slots,delete e.$self,delete e.$error,delete e.$component,delete e.$rerender}function xt(e){if(!(typeof __DEBUG__<"u"&&!__DEBUG__)&&u("console")){if(L.outputFormat==="llm"){Promise.resolve().then(()=>(ne(),Et)).then(({formatErrorForLLM:t})=>{console.log(t(e))});return}console.log("%c\u{1F534} boreDOM: Error in %c<%s>%c render","color: #ff6b6b; font-weight: bold","color: #4ecdc4; font-weight: bold",e.component,"color: #ff6b6b"),console.error(e.error),u("globals")&&(console.log("%c\u{1F4CB} Debug context loaded:","color: #95a5a6; font-weight: bold"),console.log("   $state     \u2192",e.state),console.log("   $refs      \u2192",e.refs),console.log("   $slots     \u2192",e.slots),console.log("   $self      \u2192",e.element),console.log("%c\u{1F4A1} Quick fixes:","color: #f39c12; font-weight: bold"),console.log("   $state.propertyName = value"),console.log("   $rerender()"),console.log("%c\u{1F4E4} When fixed:","color: #27ae60; font-weight: bold"),console.log(`   boreDOM.export('${e.component}')`))}}function kt(e,t){console.error(`[boreDOM] Render error in <${e}>: ${t.message}`)}function vt(e,t){typeof __DEBUG__<"u"&&!__DEBUG__||u("console")&&(console.log("%c\u{1F534} boreDOM: Error in %c<%s>%c init","color: #ff6b6b; font-weight: bold","color: #4ecdc4; font-weight: bold",e,"color: #ff6b6b"),console.error(t))}function Dt(e){typeof __DEBUG__<"u"&&!__DEBUG__||u("errorHistory")&&(O.set(e.component,e),E=e)}function De(e){typeof __DEBUG__<"u"&&!__DEBUG__||u("errorHistory")&&(e?(O.delete(e),E?.component===e&&(E=null)):E&&(O.delete(E.component),E=null))}function Tt(e){typeof __DEBUG__<"u"&&!__DEBUG__||u("visualIndicators")&&e.setAttribute("data-boredom-error","true")}function Te(e){e.removeAttribute("data-boredom-error")}function xn(e){let t=e?O.get(e):E;if(!t)return null;try{return{component:t.component,state:JSON.parse(JSON.stringify(t.state)),timestamp:new Date(t.timestamp).toISOString(),error:t.error.message}}catch(r){return u("console")&&console.warn(`[boreDOM] exportState: Unable to serialize state for <${t.component}>:`,r instanceof Error?r.message:r),{component:t.component,state:"[Unable to serialize - contains circular references or functions]",timestamp:new Date(t.timestamp).toISOString(),error:t.error.message}}}var L,O,E,w,A=v(()=>{"use strict";L={console:!0,globals:!0,errorBoundary:!0,visualIndicators:!0,errorHistory:!0,versionLog:!0,api:!0,methodMissing:!0,templateInference:!0,strict:!1,outputFormat:"human",llm:!0},O=new Map,E=null;w={get errors(){return O},get lastError(){return E},rerender(e){let t=e?O.get(e):E;t?t.rerender():console.warn("[boreDOM] No error context found to rerender")},clearError(e){let t=e?O.get(e):E;t?(Te(t.element),De(e),Mt()):u("console")&&console.warn(e?`[boreDOM] clearError: No error found for <${e}>`:"[boreDOM] clearError: No error to clear")},export:xn,get config(){return H()}}});function q(e,t=new WeakSet){if(e===null)return{kind:"primitive",value:"null"};if(e===void 0)return{kind:"primitive",value:"undefined"};let r=typeof e;if(r==="string")return{kind:"primitive",value:"string"};if(r==="number")return{kind:"primitive",value:"number"};if(r==="boolean")return{kind:"primitive",value:"boolean"};if(r==="function")return{kind:"function",params:[],returnType:{kind:"unknown"}};if(e instanceof Date)return{kind:"date"};if(Array.isArray(e)){if(e.length===0)return{kind:"array",elementType:{kind:"unknown"}};let n=Math.min(5,e.length),o=[];for(let i=0;i<n;i++)o.push(q(e[i],t));return{kind:"array",elementType:x(o)}}if(r==="object"){if(t.has(e))return{kind:"unknown"};t.add(e);let n={};for(let[o,i]of Object.entries(e))typeof o!="symbol"&&(n[o]=q(i,t));return{kind:"object",properties:n}}return{kind:"unknown"}}function x(e){let t=e.filter(n=>n.kind!=="unknown");if(t.length===0)return{kind:"unknown"};if(t.length===1)return t[0];if(t.every(n=>n.kind==="primitive")){let n=t,o=[...new Set(n.map(i=>i.value))];return o.length===1?t[0]:{kind:"union",types:o.map(i=>({kind:"primitive",value:i}))}}if(t.every(n=>n.kind==="object")){let n=t,o={};for(let i of n)for(let[s,a]of Object.entries(i.properties))o[s]?o[s]=x([o[s],a]):o[s]=a;return{kind:"object",properties:o}}if(t.every(n=>n.kind==="array")){let o=t.map(i=>i.elementType);return{kind:"array",elementType:x(o)}}let r=kn(t);return r.length===1?r[0]:{kind:"union",types:r}}function kn(e){let t=new Set,r=[];for(let n of e){let o=G(n);t.has(o)||(t.add(o),r.push(n))}return r}function G(e){switch(e.kind){case"primitive":return`p:${e.value}`;case"literal":return`l:${typeof e.value}:${e.value}`;case"array":return`a:${G(e.elementType)}`;case"object":return`o:{${Object.entries(e.properties).sort(([n],[o])=>n.localeCompare(o)).map(([n,o])=>`${n}:${G(o)}`).join(",")}}`;case"union":return`u:[${e.types.map(G).sort().join("|")}]`;case"function":return`f:(${e.params.map(n=>`${n.name}:${G(n.type)}`).join(",")})=>${G(e.returnType)}`;case"date":return"date";case"unknown":return"unknown"}}function vn(e,t){let r=Math.max(e.length,t.length),n=[];for(let o=0;o<r;o++){let i=e[o],s=t[o];i&&s?n.push({name:i.name,type:x([i.type,s.type]),optional:i.optional||s.optional}):i?n.push({...i,optional:!0}):s&&n.push({...s,optional:!0})}return n}function Lt(e,t){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return;let r=N.get(e),n=q(t);if(r){let o=x([r.type,n]);N.set(e,{path:e,type:o,accessCount:r.accessCount+1})}else N.set(e,{path:e,type:n,accessCount:1})}function rt(e,t,r){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return;let n=P.get(e),o=t.map((s,a)=>({name:Dn(s,a),type:q(s),optional:!1})),i=q(r);if(n){let s=vn(n.params,o),a=x([n.returnType,i]);P.set(e,{params:s,returnType:a,callCount:n.callCount+1})}else P.set(e,{params:o,returnType:i,callCount:1})}function Dn(e,t){if(e==null)return`arg${t}`;let r=typeof e;return r==="string"?e.includes("@")?"email":e.match(/^\d{4}-\d{2}-\d{2}/)?"date":e.length>100?"text":"str":r==="number"?Number.isInteger(e)?e>1e12?"timestamp":"count":"value":r==="boolean"?"flag":Array.isArray(e)?"items":r==="object"?e instanceof Date?"date":"data":`arg${t}`}function g(e,t=0){let r="  ".repeat(t);switch(e.kind){case"primitive":return e.value;case"literal":return typeof e.value=="string"?`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:String(e.value);case"array":let n=g(e.elementType,t);return e.elementType.kind==="primitive"||e.elementType.kind==="unknown"?`${n}[]`:`Array<${n}>`;case"object":{let i=Object.entries(e.properties);return i.length===0?"{}":`{
${i.map(([a,c])=>`${r}  ${a}: ${g(c,t+1)};`).join(`
`)}
${r}}`}case"union":return e.types.map(i=>g(i,t)).join(" | ");case"function":return`(${e.params.map(s=>`${s.name}${s.optional?"?":""}: ${g(s.type)}`).join(", ")}) => ${g(e.returnType)}`;case"date":return"Date";case"unknown":return"unknown"}}function Be(){let e={};for(let[t,r]of N)Tn(e,t,r.type);return Oe(e)}function Tn(e,t,r){let n=t.split("."),o=e;for(let a=0;a<n.length-1;a++){let c=n[a],l=c.match(/^(.+)\[(\d+)\]$/);if(l){let[,f]=l;o[f]||(o[f]={__isArray:!0,__elementType:{}}),o=o[f].__elementType}else o[c]||(o[c]={}),o=o[c]}let i=n[n.length-1],s=i.match(/^(.+)\[(\d+)\]$/);if(s){let[,a]=s;o[a]||(o[a]={__isArray:!0,__elementType:{}});let c=o[a].__elementType.__type;c?o[a].__elementType.__type=x([c,r]):o[a].__elementType.__type=r}else{let a=o[i]?.__type;a?o[i]={__type:x([a,r])}:o[i]={__type:r}}}function Oe(e){if(e.__type)return e.__type;if(e.__isArray)return{kind:"array",elementType:Oe(e.__elementType)};let t={};for(let[r,n]of Object.entries(e))r.startsWith("__")||n&&typeof n=="object"&&(t[r]=Oe(n));return Object.keys(t).length===0?{kind:"unknown"}:{kind:"object",properties:t}}function $n(){let e=Be();return e.kind==="unknown"?"interface State {}":`interface State ${g(e)}`}function $t(){return{state:"interface State {}",helpers:{},components:{},events:{},raw:{state:{kind:"object",properties:{}},helpers:{},components:{},events:{}}}}function St(){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return $t();let e={};for(let[s,a]of P)e[s]=g({kind:"function",params:a.params,returnType:a.returnType});let t={};for(let[s,a]of $e)t[s]=g({kind:"object",properties:a});let r={};for(let[s,a]of Le)r[s]=g(a);let n={};for(let[s,a]of P)n[s]=a;let o={};for(let[s,a]of $e)o[s]={kind:"object",properties:a};let i={};for(let[s,a]of Le)i[s]=a;return{state:$n(),helpers:e,components:t,events:r,raw:{state:Be(),helpers:n,components:o,events:i}}}function Ct(e){if(typeof __DEBUG__<"u"&&!__DEBUG__||!u("llm"))return"unknown";let t=N.get(e);if(t)return g(t.type);let r=Be(),n=Ln(r,e);return n?g(n):"unknown"}function Ln(e,t){let r=t.split("."),n=e;for(let o of r){let i=o.match(/^(.+)\[(\d+)\]$/);if(i){let[,s]=i;if(n.kind==="object"&&n.properties[s])n=n.properties[s];else return null;if(n.kind==="array")n=n.elementType;else return null}else if(o.endsWith("[]")){let s=o.slice(0,-2);if(n.kind==="object"&&n.properties[s])n=n.properties[s];else return null}else if(n.kind==="object"&&n.properties[o])n=n.properties[o];else return null}return n}function wt(){N.clear(),P.clear(),$e.clear(),Le.clear()}var N,P,$e,Le,Z=v(()=>{"use strict";A();N=new Map,P=new Map,$e=new Map,Le=new Map});var Fe=async e=>{let t=new Map;for(let r=0;r<e.length;++r){let i=Array.from(Ne("script[src]")).find(a=>((a.getAttribute("src")??"").split("/").pop()??"")===`${e[r]}.js`)?.getAttribute("src"),s=null;if(i)try{let c=await import(new URL(i,document.baseURI).href);for(let l of Object.keys(c)){s=c[l];break}t.set(e[r],s)}catch(a){console.error(`Unable to import "${i}"`,a)}}return t},He=()=>Array.from(Ne("template[data-component]")).filter(e=>e instanceof HTMLElement).map(e=>{let t={name:"",attributes:[]};for(let r in e.dataset)r==="component"?t.name=e.dataset[r]??"":t.attributes.push([Pt(r),e.dataset[r]??""]);if(t.name==="")throw new Error(`A <template> was found with an invalid data-component: "${e.dataset.component}"`);return t}).map(({name:e,attributes:t})=>(je(e,{attributes:t}),e)),ce=(e,t)=>{let r=I(e);if(!J(r)){let n=`The tag name "${e}" is not a BoreDOM  component.
      
"createComponent" only accepts tag-names with matching <template> tags that have a data-component attribute in them.`;throw console.error(n),new Error(n)}return t&&(r.renderCallback=t),r},Gt=e=>{let t=Ge(e);if(!(t===null||!J(t)))return t},Ge=e=>document.querySelector(e),Ne=e=>document.querySelectorAll(e),I=(e,t)=>{let r=document.createElement(e);return t&&Array.isArray(t)&&t.length>0&&t.map(n=>r.appendChild(n)),r};var Nt=(e,t)=>{document.readyState==="loading"?addEventListener("DOMContentLoaded",()=>dispatchEvent(new CustomEvent(e,{detail:t}))):dispatchEvent(new CustomEvent(e,{detail:t}))};var Pe=e=>typeof e=="object",Ue=e=>typeof e=="function",J=e=>Pe(e)&&"isBored"in e&&!!e.isBored;var Pt=e=>{if(e===""||!e.split("").some(r=>r!==r.toLowerCase()))return e;let t="";for(let r=0;r<e.length;r++){let n=e[r];n===n.toUpperCase()&&r!==0&&(t+="-"),t+=n.toLowerCase()}return t};var ie=e=>e.startsWith("on"),jt=e=>e.startsWith("queriedOn"),se=e=>ie(e)?e.slice(2).toLowerCase():e.slice(9).toLowerCase(),ae=class extends HTMLElement{},je=(e,t={})=>{customElements.get(e)||customElements.define(e,class extends ae{static get observedAttributes(){return typeof t.attributeChangedCallback=="object"?Object.keys(t.attributeChangedCallback):[]}constructor(){super()}isBored=!0;traverse(r,{traverseShadowRoot:n,query:o}={}){Array.from(n?this.shadowRoot?.querySelectorAll(o??"*")??[]:[]).concat(Array.from(this.querySelectorAll(o??"*"))).filter(i=>i instanceof HTMLElement).forEach(r)}#e(r){return r.split("'").filter(n=>n.length>2&&!(n.includes("(")||n.includes(",")||n.includes(")")))}#t(){let r;this.traverse(n=>{if(n instanceof HTMLElement){customElements.get(n.tagName.toLowerCase())&&(r=n);for(let i=0;i<n.attributes.length;i++){let s=n.attributes[i];if(ie(s.name)){let a=this.#e(s.value);a.length>0&&a.forEach(c=>{n.addEventListener(se(s.name),l=>Nt(c,{event:l,dispatcher:n,component:this,index:this.parentElement?Array.from(this.parentElement.children).indexOf(this):-1}))}),n.setAttribute(`data-${s.name}-dispatches`,a.join()),n.removeAttribute(s.name)}}}},{traverseShadowRoot:!0})}isInitialized=!1;#n(){let r=Ge(`[data-component="${e}"]`)??I("template"),n=r.getAttribute("shadowrootmode");if(t.style||t.shadow||n){let i=t.shadowrootmode??n??"open",s=this.attachShadow({mode:i});if(t.style){let a=I("style");a.textContent=t.style,s.appendChild(a)}if(t.shadow){let a=I("template");a.innerHTML=t.shadow,s.appendChild(a.content.cloneNode(!0))}else n&&s.appendChild(r.content.cloneNode(!0))}r&&!n&&this.appendChild(r.content.cloneNode(!0)),t.onSlotChange&&this.traverse(i=>{i instanceof HTMLSlotElement&&i.addEventListener("slotchange",s=>t.onSlotChange?.(s))},{traverseShadowRoot:!0}),Ue(t.onClick)&&this.addEventListener("click",t.onClick);for(let[i,s]of Object.entries(t))if(ie(i)){if(!Ue(s))continue;this.addEventListener(se(i),s)}else if(jt(i)){let a=s;if(!Pe(a))continue;let c=se(i);for(let[l,f]of Object.entries(a))this.traverse(p=>{p.addEventListener(c,f)},{traverseShadowRoot:!0,query:l})}t.attributes&&Array.isArray(t.attributes)&&t.attributes.map(([i,s])=>this.setAttribute(i,s)),this.#t(),this.isInitialized=!0}renderCallback=r=>{};connectedCallback(){this.isInitialized||this.#n(),this.renderCallback(this),t.connectedCallback?.(this)}slots=K(this);updateSlot(r,n,o){document.createElement(o).setAttribute("slot",r)}disconnectedCallback(){t.disconnectedCallback?.(this)}adoptedCallback(){t.adoptedCallback?.(this)}attributeChangedCallback(r,n,o){t.attributeChangedCallback&&t.attributeChangedCallback[r]({element:this,name:r,oldValue:n,newValue:o})}})},le=e=>{je(e,{})};function We(e,t){let r=t;return t===null||e.forEach(n=>{r=r[n]}),r}function ze(e,t=[]){let r=[{path:[],obj:e}],n=[],o=new WeakSet;for(;r.length>0;){let{path:i,obj:s}=r.pop();if(!o.has(s)){o.add(s);for(let a in s){if(t.includes(a))continue;let c=s[a],l=i.concat(a);typeof c=="object"&&c!==null&&!o.has(c)&&r.push({path:l,obj:c}),n.push({path:l,value:c})}}}return n}function D(e){if(e==null||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t==null?!0:t===Object.prototype}Z();function Ot(e,t,r){return(n,o)=>{addEventListener(n,i=>{let s=i?.detail?.event.currentTarget,a;for(;s;){if(s===e){try{let c=o({state:t,e:i.detail,detail:r});Promise.resolve(c).catch(l=>{console.error(`Error in async handler for "${n}" event`,l)})}catch(c){console.error(`Error in handler for "${n}" event`,c)}return}s instanceof HTMLElement?s=s.parentElement:s=void 0}})}}function Bt(e){return new Proxy({},{get(t,r,n){let o=new Error(`Ref "${String(r)}" not found in <${e.tagName}>`);if(typeof r=="string"){let i=e.querySelectorAll(`[data-ref="${r}"]`);if(!i)throw o;let s=Array.from(i).filter(a=>a instanceof HTMLElement);if(s.length===0)throw o;return s.length===1?s[0]:s}}})}function K(e){return new Proxy({},{get(t,r,n){let o=new Error(`Slot "${String(r)}" not found in <${e.tagName}>`);if(typeof r=="string"){let i=e.querySelectorAll(`slot[name="${r}"]`);if(!i)throw o;let s=Array.from(i).filter(a=>a instanceof HTMLSlotElement);if(s.length===0)throw o;return s.length===1?s[0]:s}},set(t,r,n){if(typeof r!="string")return!1;let o=n;if(n instanceof HTMLElement)n.setAttribute("data-slot",r);else if(typeof n=="string")o=I("span"),o.setAttribute("data-slot",r),o.innerText=n;else throw new Error(`Invalid value for slot ${r} in <${e.tagName}>`);let i=Array.from(e.querySelectorAll(`[data-slot="${r}"]`));return i.length>0?i.forEach(s=>s.parentElement?.replaceChild(o,s)):Array.from(e.querySelectorAll(`slot[name="${r}"]`)).forEach(a=>a.parentElement?.replaceChild(o,a)),!0}})}function Ie(e,t,r){let n=r||{targets:new WeakMap,path:[]};if(e!==void 0)return new Proxy(e,{set(o,i,s){return typeof i=="string"&&console.error(`State is read-only for web components. Unable to set '${i}'.`),!1},get(o,i,s){let a=Reflect.get(o,i,s),c=i==="__proto__";if(typeof i=="string"&&!c&&(n.targets.has(o)||(n.targets.set(o,n.path.join(".")),n.path.push(i))),c||Array.isArray(a)||D(a))return Ie(a,t,n);let l=n.targets.get(o)??"";return typeof l=="string"&&typeof i=="string"&&(Array.isArray(o)||(l+=l!==""?`.${i}`:i),t.indexOf(l)===-1&&t.push(l)),n.path.length=0,n.path.push(l),(typeof __DEBUG__>"u"||__DEBUG__)&&typeof l=="string"&&l!==""&&Lt(l,a),a}})}function On(e){return()=>{let t=e.internal.updates,r=new Set,n=o=>{if(o)for(let i=0;i<o.length;i++){let s=o[i];if(!r.has(s)){r.add(s);try{s(e.app)}catch{}}}};for(let o=0;o<t.path.length;o++){let i=t.path[o],s=i.slice(i.indexOf(".")+1);n(t.subscribers.get(s));for(let[a,c]of t.subscribers.entries()){if(a===s)continue;let l=`${a}.`,f=`${s}.`;(s.startsWith(l)||a.startsWith(f))&&n(c)}}t.path=[],t.value=[],t.raf=void 0}}function It(e){let t=e.internal,r=e;if(r===void 0)return e;let n=new WeakSet,o=Symbol("boredom-proxy");function i(a,c){if(n.has(a))return a;let l=new Proxy(a,{get(f,p,d){return p===o?!0:Reflect.get(f,p,d)},set(f,p,d){if(!(f[p]!==d))return!0;if(typeof p=="string"){let y=Array.isArray(a)?c:`${c}.${p}`;!(d&&d[o]===!0)&&(Array.isArray(d)||D(d))&&(d=s(d,y))}return Reflect.set(f,p,d),typeof p!="string"||(Array.isArray(a)?t.updates.path.push(`${c}`):t.updates.path.push(`${c}.${p}`),t.updates.value.push(f),t.updates.raf||(t.updates.raf=requestAnimationFrame(On(e)))),!0}});return n.add(a),n.add(l),l}function s(a,c){if(!Array.isArray(a)&&!D(a)||n.has(a)||a&&a[o]===!0)return a;if(Array.isArray(a))for(let l=0;l<a.length;l++){let f=a[l];(Array.isArray(f)||D(f))&&(a[l]=s(f,c))}else for(let l of Object.keys(a)){let f=a[l];(Array.isArray(f)||D(f))&&(a[l]=s(f,`${c}.${l}`))}return i(a,c)}return ze(e,["internal"]).forEach(({path:a,value:c})=>{if(Array.isArray(c)||D(c)&&!n.has(c)){let f=a.join("."),p=We(a.slice(0,-1),r);if(p===c)return;p[a.at(-1)]=i(c,f)}}),e}function Rt(e){let t=e.internal.customTags.filter(n=>document.querySelector(n)!==null),r=e.internal.components;for(let[n,o]of r.entries()){if(o===null||!t.includes(n))continue;let i=Array.from(document.querySelectorAll(n)).filter(s=>J(s));i.length!==0&&i.forEach((s,a)=>{o(e,{index:a,name:n,data:void 0})(s)})}}function Re(e,t,r){let n=t.internal.components.get(e);if(n){let o={...r,tagName:e};return ce(e,n(t,o))}return ce(e)}A();Y();ye();ne();A();ee();ee();var Ut=!1,Bn={get errors(){return w.errors},get lastError(){return w.lastError},rerender:w.rerender,clearError:w.clearError,export:w.export,get config(){return w.config},_setDebugConfig:re,version:T,define:Q.define,operate:Q.operate,exportComponent:Q.exportComponent,get missingFunctions(){return m.missingFunctions},get lastMissing(){return m.lastMissing},defineHelper:m.defineHelper,get helpers(){return m.helpers},clearHelper:m.clearHelper,clearMissingFunctions:m.clearMissingFunctions,get inferredTemplates(){return m.inferredTemplates},inferTemplate:m.inferTemplate,llm:ve};typeof window<"u"&&(window.boreDOM=Bn);async function Mr(e,t,r){r?.debug!==void 0&&re(r.debug),!Ut&&u("versionLog")&&(Ut=!0,typeof console<"u"&&typeof console.info=="function"&&console.info(`[boreDOM] v${T}`));let n=He(),o=await Fe(n);if(t)for(let a of Object.keys(t))o.set(a,t[a]);let s=It({app:e,internal:{customTags:n,components:o,updates:{path:[],value:[],raf:void 0,subscribers:new Map}}});return s.internal.updates.path=[],s.internal.updates.value=[],s.internal.updates.raf&&(cancelAnimationFrame(s.internal.updates.raf),s.internal.updates.raf=void 0),Ve(s,In,le),z(s),typeof window<"u"&&window.boreDOM?.llm?._setValidationAppState&&window.boreDOM.llm._setValidationAppState(s),Rt(s),tt(),s.app}function In(e){let t=null,r,n=(o,i)=>s=>{let{internal:a,app:c}=o,l=[],f=Ie(c,l),p=Bt(s),d=K(s),V=Ot(s,c,i);if(t!==s){let y=async()=>{let S=a.updates.subscribers;for(let C of l){let B=S.get(C);B?B.includes(r)||B.push(r):S.set(C,[r])}},j;try{j=e({detail:i,state:f,refs:p,on:V,self:s})}catch(S){let C=S;u("console")&&vt(i?.name??s.tagName.toLowerCase(),C),j=()=>{}}r=S=>{let C=i?.name??s.tagName.toLowerCase(),B=Xe(C,s,()=>r(S));if(u("errorBoundary"))try{j({state:S,refs:p,slots:d,self:s,detail:i,makeComponent:(W,k)=>Re(W,o,k?.detail),helpers:B}),y(),Te(s),De(C)}catch(W){let k=W,oe={component:C,element:s,error:k,state:c,refs:p,slots:d,timestamp:Date.now(),rerender:()=>r(S),stack:k.stack??""};u("console")?xt(oe):kt(C,k),At(oe),Dt(oe),Tt(s)}else j({state:S,refs:p,slots:d,self:s,detail:i,makeComponent:(W,k)=>Re(W,o,k?.detail),helpers:B}),y()},Je(s,{state:c,refs:p,slots:d,self:s,detail:i,rerender:()=>r(c)})}r(f),t=s};return n[pe]=!0,n}export{T as VERSION,Bn as boreDOM,Mt as clearGlobals,H as getDebugConfig,Mr as inflictBoreDOM,u as isDebugEnabled,Gt as queryComponent,le as registerComponent,re as setDebugConfig,In as webComponent};
